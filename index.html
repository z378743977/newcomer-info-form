<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç…§ç‰‡ç¼–è¾‘</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #F5F5F0 0%, #D4E4E7 50%, #B8D4D6 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
        }
        
        body.lang-ru,
        body.lang-ru * {
            letter-spacing: 0.5px !important;
        }
        
        body.lang-ru h1 {
            letter-spacing: 2px !important;
        }
        
        body.lang-ru .choice-card h2,
        body.lang-ru .language-card h2,
        body.lang-ru .modal-content h2 {
            letter-spacing: 1px !important;
        }
        
        body.lang-vi,
        body.lang-vi * {
            letter-spacing: 0.5px !important;
        }
        
        body.lang-vi h1 {
            letter-spacing: 2px !important;
        }
        
        body.lang-vi .choice-card h2,
        body.lang-vi .language-card h2,
        body.lang-vi .modal-content h2 {
            letter-spacing: 1px !important;
        }
        
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(62, 95, 138, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }
        
        .container {
            background: #FAFAF8;
            border: 3px solid #A8DADC;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 
                0 8px 16px rgba(62, 95, 138, 0.2),
                inset 0 0 0 1px rgba(168, 218, 220, 0.3);
            max-width: 900px;
            width: 100%;
            position: relative;
        }
        
        .container::before,
        .container::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border: 2px solid #4A90A4;
        }
        
        .container::before {
            top: -2px;
            left: -2px;
            border-right: none;
            border-bottom: none;
        }
        
        .container::after {
            top: -2px;
            right: -2px;
            border-left: none;
            border-bottom: none;
        }
        
        h1 {
            text-align: center;
            color: #2E4F7A;
            margin-bottom: 20px;
            font-size: 32px;
            font-weight: normal;
            letter-spacing: 8px;
            position: relative;
            padding-bottom: 15px;
        }
        
        h1::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 2px;
            background: linear-gradient(90deg, transparent, #4A90A4, transparent);
        }

        /* è¯­è¨€åˆ‡æ¢æŒ‰é’® - æ”¾åœ¨æ ‡é¢˜ä¸‹æ–¹ */
        .lang-switch {
            display: block;
            margin: 0 auto 30px;
            padding: 12px 24px;
            background: #4A90A4;
            color: #FAFAF8;
            border: 2px solid #3E7A8D;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
            box-shadow: 2px 2px 0 rgba(0,0,0,0.2);
            max-width: 180px;
            font-weight: 600;
            letter-spacing: 2px;
        }

        .lang-switch:hover {
            background: #3E7A8D;
            transform: translate(1px, 1px);
            box-shadow: 1px 1px 0 rgba(0,0,0,0.2);
        }

        /* è¯­è¨€é€‰æ‹©ç•Œé¢ */
        .language-selector {
            text-align: center;
        }

        .language-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-top: 30px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .language-card {
            padding: 30px 20px;
            border: 2px solid #A8DADC;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            background: #F5F8F9;
            box-shadow: 2px 2px 8px rgba(62, 95, 138, 0.15);
        }

        .language-card:hover {
            border-color: #4A90A4;
            transform: translateY(-3px);
            box-shadow: 3px 3px 12px rgba(74, 144, 164, 0.3);
            background: #FFF;
        }

        .language-card .flag {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .language-card h2 {
            font-size: 22px;
            color: #2E4F7A;
            font-weight: normal;
            letter-spacing: 2px;
        }

        /* ä¸»é€‰æ‹©ç•Œé¢ */
        .main-choice {
            display: flex;
            gap: 30px;
            margin-top: 40px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .choice-card {
            flex: 1;
            min-width: 250px;
            padding: 40px 30px;
            border: 2px solid #A8DADC;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #F5F8F9;
            position: relative;
            box-shadow: 2px 2px 8px rgba(62, 95, 138, 0.15);
        }

        .choice-card:hover {
            border-color: #4A90A4;
            transform: translateY(-3px);
            box-shadow: 3px 3px 12px rgba(74, 144, 164, 0.3);
            background: #FFF;
        }

        .choice-card .icon {
            font-size: 60px;
            margin-bottom: 20px;
        }

        .choice-card h2 {
            font-size: 22px;
            color: #2E4F7A;
            margin-bottom: 15px;
            font-weight: normal;
            letter-spacing: 2px;
        }

        .choice-card p {
            color: #5A7A8F;
            font-size: 14px;
            line-height: 1.8;
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #2C3E50;
            font-weight: normal;
            font-size: 15px;
            letter-spacing: 1px;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #D4E4E7;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
            background: white;
            font-family: inherit;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: #3E5F8A;
            background: #FFF;
            box-shadow: 0 0 0 3px rgba(62, 95, 138, 0.1);
        }
        
        input[type="file"] {
            width: 100%;
            padding: 30px;
            border: 2px dashed #A8DADC;
            border-radius: 8px;
            cursor: pointer;
            background: #F5F8F9;
            font-size: 16px;
            text-align: center;
            font-family: inherit;
            transition: all 0.3s;
        }
        
        input[type="file"]:hover {
            border-color: #4A90A4;
            background: #FFF;
        }
        
        input[type="file"]::file-selector-button {
            padding: 10px 20px;
            background: #3E5F8A;
            color: #FAFAF8;
            border: 2px solid #2E4F7A;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 15px;
            font-family: inherit;
            letter-spacing: 1px;
            box-shadow: 2px 2px 0 rgba(0,0,0,0.2);
            transition: all 0.2s;
        }
        
        input[type="file"]::file-selector-button:hover {
            background: #2E4F7A;
            transform: translate(1px, 1px);
            box-shadow: 1px 1px 0 rgba(0,0,0,0.2);
        }
        
        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #3E5F8A 0%, #2E4F7A 100%);
            color: #FAFAF8;
            border: 3px solid #2E4F7A;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
            font-family: inherit;
            letter-spacing: 3px;
            box-shadow: 0 4px 12px rgba(62, 95, 138, 0.2);
            position: relative;
        }
        
        .btn:hover {
            background: linear-gradient(135deg, #2E4F7A 0%, #1E3A5F 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(62, 95, 138, 0.3);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn.back {
            background: #5A7A8F;
            border-color: #4A6A7F;
            margin-bottom: 20px;
        }
        
        .btn.back:hover {
            background: #4A6A7F;
        }
        
        .error {
            color: #C73E1D;
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }
        
        .file-info {
            font-size: 14px;
            color: #5A7A8F;
            margin-top: 8px;
        }
        
        .editor-area {
            display: none;
            margin-top: 30px;
        }
        
        .image-editor {
            margin-bottom: 30px;
            padding: 20px;
            background: #F5F8F9;
            border: 2px solid #D4E4E7;
            border-radius: 8px;
        }
        
        .editor-title {
            font-size: 18px;
            font-weight: normal;
            color: #2E4F7A;
            margin-bottom: 15px;
            letter-spacing: 2px;
        }
        
        .canvas-container {
            position: relative;
            display: inline-block;
            max-width: 100%;
        }
        
        .edit-canvas {
            border: 2px solid #3E5F8A;
            border-radius: 8px;
            cursor: crosshair;
            max-width: 100%;
            display: block;
            box-shadow: 2px 2px 8px rgba(62, 95, 138, 0.15);
        }
        
        .instruction {
            margin-top: 10px;
            padding: 10px;
            background: #FFF;
            border: 1px solid #D4E4E7;
            border-radius: 6px;
            font-size: 14px;
            color: #5A7A8F;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .point-info {
            color: #3E5F8A;
            font-weight: normal;
            letter-spacing: 1px;
        }
        
        .control-buttons {
            display: flex;
            gap: 10px;
        }
        
        .small-btn {
            padding: 6px 12px;
            background: #C73E1D;
            color: #FAFAF8;
            border: 2px solid #A32E15;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
            letter-spacing: 1px;
            box-shadow: 2px 2px 0 rgba(0,0,0,0.2);
        }
        
        .small-btn:hover {
            transform: translate(1px, 1px);
            box-shadow: 1px 1px 0 rgba(0,0,0,0.2);
        }
        
        .small-btn:active {
            transform: translate(2px, 2px);
            box-shadow: none;
        }

        .small-btn.undo {
            background: #F7B500;
            border-color: #D99C00;
        }

        .small-btn.rotate {
            background: #3E5F8A;
            border-color: #2E4F7A;
        }
        
        .preview {
            margin-top: 30px;
            text-align: center;
        }
        
        #result {
            max-width: 100%;
            border: 3px solid #A8DADC;
            border-radius: 8px;
            box-shadow: 3px 3px 12px rgba(62, 95, 138, 0.3);
            margin-top: 20px;
        }

        .step-indicator {
            text-align: center;
            margin-bottom: 20px;
            font-size: 16px;
            color: #3E5F8A;
            font-weight: normal;
            letter-spacing: 2px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(46, 79, 122, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #FAFAF8;
            padding: 40px;
            border: 3px solid #A8DADC;
            border-radius: 12px;
            max-width: 500px;
            text-align: center;
            box-shadow: 
                0 8px 24px rgba(62, 95, 138, 0.4),
                inset 0 0 0 1px rgba(168, 218, 220, 0.3);
            position: relative;
        }
        
        .modal-content::before,
        .modal-content::after {
            content: '';
            position: absolute;
            width: 15px;
            height: 15px;
            border: 2px solid #4A90A4;
        }
        
        .modal-content::before {
            bottom: -2px;
            left: -2px;
            border-right: none;
            border-top: none;
        }
        
        .modal-content::after {
            bottom: -2px;
            right: -2px;
            border-left: none;
            border-top: none;
        }

        .modal-content h2 {
            margin-bottom: 20px;
            color: #2E4F7A;
            font-weight: normal;
            letter-spacing: 3px;
        }

        .modal-content p {
            margin-bottom: 25px;
            color: #5A7A8F;
            line-height: 1.8;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .modal-btn {
            padding: 12px 30px;
            border: 2px solid #2E4F7A;
            border-radius: 6px;
            font-size: 16px;
            font-weight: normal;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
            letter-spacing: 2px;
            box-shadow: 2px 2px 0 rgba(0,0,0,0.2);
        }

        .modal-btn:hover {
            transform: translate(1px, 1px) scale(1.02);
            box-shadow: 1px 1px 0 rgba(0,0,0,0.2);
        }

        .modal-btn:active {
            transform: translate(2px, 2px);
            box-shadow: none;
        }

        .modal-btn.yes {
            background: #4A90A4;
            color: #FAFAF8;
        }

        .modal-btn.no {
            background: #3E5F8A;
            color: #FAFAF8;
        }

        .contact-info {
            background: #F5F8F9;
            padding: 20px;
            border: 1px solid #D4E4E7;
            border-radius: 8px;
            margin-top: 20px;
        }

        .contact-info p {
            margin: 10px 0;
            font-size: 16px;
            color: #2C3E50;
        }

        .hidden {
            display: none !important;
        }

        /* æ‰‹æœºç«¯é€‚é… */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 24px;
                letter-spacing: 4px;
            }

            .lang-switch {
                font-size: 14px;
                padding: 10px 18px;
            }

            .language-grid {
                max-width: 100%;
            }

            .language-card .flag {
                font-size: 36px;
            }

            .language-card h2 {
                font-size: 20px;
            }

            .main-choice {
                flex-direction: column;
            }

            .choice-card {
                min-width: 100%;
            }

            .modal-content {
                padding: 30px 20px;
                margin: 20px;
            }

            .instruction {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }

            .control-buttons {
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- è¯­è¨€é€‰æ‹©ç•Œé¢ -->
        <div id="languageSelect">
            <h1>é€‰æ‹©è¯­è¨€ / Select Language</h1>
            <div class="language-grid">
                <div class="language-card" onclick="selectLanguage('zh')">
                    <div class="flag">ğŸ‡¨ğŸ‡³</div>
                    <h2>ç®€ä½“ä¸­æ–‡</h2>
                </div>
                <div class="language-card" onclick="selectLanguage('vi')">
                    <div class="flag">ğŸ‡»ğŸ‡³</div>
                    <h2>Tiáº¿ng Viá»‡t</h2>
                </div>
                <div class="language-card" onclick="selectLanguage('ru')">
                    <div class="flag">ğŸ‡·ğŸ‡º</div>
                    <h2>Ğ ÑƒÑÑĞºĞ¸Ğ¹</h2>
                </div>
                <div class="language-card" onclick="selectLanguage('ko')">
                    <div class="flag">ğŸ‡°ğŸ‡·</div>
                    <h2>í•œêµ­ì–´</h2>
                </div>
            </div>
        </div>

        <h1 id="mainTitle" class="hidden">ç…§ç‰‡ç¼–è¾‘</h1>
        
        <button class="lang-switch hidden" onclick="backToLanguageSelect()">ğŸŒ <span id="langSwitchText">åˆ‡æ¢è¯­è¨€</span></button>
        
        <!-- ä¸»é€‰æ‹©ç•Œé¢ -->
        <div id="mainChoice" class="hidden">
            <p style="text-align: center; color: #5A7A8F; margin-bottom: 20px;" id="chooseTypeText">è¯·é€‰æ‹©æ‚¨çš„ç…§ç‰‡ç±»å‹</p>
            <div class="main-choice">
                <div class="choice-card" onclick="selectMode('edited')">
                    <div class="icon">âœ…</div>
                    <h2 id="editedCardTitle">å·²ç¼–è¾‘å¥½çš„ç…§ç‰‡</h2>
                    <p id="editedCardDesc">å·²ç»åˆæˆå¥½çš„ç…§ç‰‡<br>å¯èƒ½éœ€è¦æ·»åŠ æˆ–ä¿®æ”¹æ‰‹æœºå·</p>
                </div>
                <div class="choice-card" onclick="selectMode('original')">
                    <div class="icon">ğŸ“·</div>
                    <h2 id="originalCardTitle">ç…§ç‰‡åŸä»¶</h2>
                    <p id="originalCardDesc">éœ€è¦åˆæˆçš„åŸå§‹ç…§ç‰‡<br>2-3å¼ ç…§ç‰‡åˆæˆä¸€å¼ </p>
                </div>
            </div>
        </div>

        <!-- å·²ç¼–è¾‘ç…§ç‰‡æµç¨‹ -->
        <div id="editedFlow" class="hidden">
            <button class="btn back" onclick="backToMain()">â† <span id="backToMainText">è¿”å›ä¸»ç•Œé¢</span></button>
            
            <div class="step-indicator" id="editedStepText">å·²ç¼–è¾‘ç…§ç‰‡å¤„ç†</div>
            
            <div class="input-group">
                <label for="editedPhoto" id="editedPhotoLabel">é€‰æ‹©å·²ç¼–è¾‘å¥½çš„ç…§ç‰‡ (1å¼ )</label>
                <input type="file" id="editedPhoto" accept="image/*">
                <div class="file-info" id="editedFileInfo">æœªé€‰æ‹©æ–‡ä»¶</div>
            </div>
            
            <button class="btn" onclick="checkEditedPhoto()" id="editedNextBtn">ä¸‹ä¸€æ­¥</button>
        </div>

        <!-- åŸä»¶ç…§ç‰‡æµç¨‹ -->
        <div id="originalFlow" class="hidden">
            <button class="btn back" onclick="backToMain()">â† <span id="backToMainText2">è¿”å›ä¸»ç•Œé¢</span></button>
            
            <div class="step-indicator" id="originalStepText">æ­¥éª¤ 1/3: è¾“å…¥ä¿¡æ¯</div>
            
            <div class="input-group">
                <label for="phone" id="phoneLabel">æ‰‹æœºå·ç </label>
                <input type="text" id="phone" placeholder="" maxlength="13">
                <div class="error" id="phoneError">è¯·è¾“å…¥æ­£ç¡®æ ¼å¼çš„æ‰‹æœºå· (xxx-xxxx-xxxx)</div>
            </div>
            
            <div class="input-group">
                <label for="photos" id="photosLabel">é€‰æ‹©ç…§ç‰‡ (2-3å¼ )</label>
                <input type="file" id="photos" accept="image/*" multiple>
                <div class="file-info" id="fileInfo">æœªé€‰æ‹©æ–‡ä»¶</div>
                <div class="error" id="fileError">è¯·é€‰æ‹©2-3å¼ ç…§ç‰‡</div>
            </div>
            
            <button class="btn" onclick="startEditing()" id="originalNextBtn">ä¸‹ä¸€æ­¥:ç¼–è¾‘ç…§ç‰‡åŒºåŸŸ</button>
        </div>

        <!-- ç¼–è¾‘åŒºåŸŸ -->
        <div class="editor-area" id="editorArea"></div>
        
        <div style="display:none;" id="backButton">
            <button class="btn back" onclick="goBackToStep1()">â† <span id="backToStep1Text">è¿”å›ä¸Šä¸€æ­¥</span></button>
        </div>
        
        <div style="display:none;" id="mergeButton">
            <button class="btn" onclick="mergePhotos()">ğŸ¨ <span id="mergeButtonText">åˆæˆç…§ç‰‡</span></button>
        </div>
        
        <div class="preview">
            <canvas id="result" style="display:none;"></canvas>
        </div>
    </div>

    <!-- å¼¹çª—ï¼šè¯¢é—®æ˜¯å¦æœ‰æ‰‹æœºå· -->
    <div class="modal" id="phoneCheckModal">
        <div class="modal-content">
            <h2 id="phoneCheckTitle">ğŸ“± ç…§ç‰‡ç¡®è®¤</h2>
            <p id="phoneCheckDesc">æ‚¨å¯¼å…¥çš„ç…§ç‰‡ä¸Šæ˜¯å¦å·²ç»æœ‰æ‰‹æœºå·?</p>
            <div class="modal-buttons">
                <button class="modal-btn yes" onclick="hasPhoneNumber()" id="hasPhoneBtn">æœ‰æ‰‹æœºå·</button>
                <button class="modal-btn no" onclick="noPhoneNumber()" id="noPhoneBtn">æ²¡æœ‰æ‰‹æœºå·</button>
            </div>
        </div>
    </div>

    <!-- å¼¹çª—ï¼šè”ç³»ç®¡ç†å‘˜ -->
    <div class="modal" id="contactModal">
        <div class="modal-content">
            <h2 id="contactTitle">âœ… ç…§ç‰‡å·²å®Œæˆ</h2>
            <p id="contactDesc1">æ‚¨çš„ç…§ç‰‡å·²ç»åŒ…å«æ‰‹æœºå·,æ— éœ€å†æ¬¡ç¼–è¾‘ã€‚</p>
            <p id="contactDesc2">å¦‚éœ€ä¿®æ”¹,è¯·è”ç³»ç®¡ç†å‘˜:</p>
            <div class="contact-info">
                <p><strong id="contactAdmin">ğŸ“ éœ€è¦ä¿®æ”¹è¯·è”ç³»ç®¡ç†å‘˜</strong></p>
                <p id="contactNote">è¯·é€šè¿‡æ‚¨çš„è”ç³»æ–¹å¼ä¸ç®¡ç†å‘˜æ²Ÿé€š</p>
            </div>
            <button class="modal-btn no" onclick="closeModal()" id="closeModalBtn">å…³é—­</button>
        </div>
    </div>

    <!-- å¼¹çª—ï¼šè¾“å…¥æ‰‹æœºå· -->
    <div class="modal" id="phoneInputModal">
        <div class="modal-content">
            <h2 id="phoneInputTitle">ğŸ“± è¾“å…¥æ‰‹æœºå·</h2>
            <p id="phoneInputDesc">è¯·è¾“å…¥è¦æ·»åŠ åˆ°ç…§ç‰‡ä¸Šçš„æ‰‹æœºå·</p>
            <div class="input-group">
                <input type="text" id="editedPhone" placeholder="" maxlength="13" style="margin-bottom: 10px;">
                <div class="error" id="editedPhoneError">è¯·è¾“å…¥æ­£ç¡®æ ¼å¼çš„æ‰‹æœºå· (xxx-xxxx-xxxx)</div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn no" onclick="confirmEditedPhone()" id="confirmPhoneBtn">ç¡®è®¤</button>
                <button class="modal-btn" style="background: #5A7A8F; border-color: #4A6A7F;" onclick="closePhoneInputModal()" id="cancelPhoneBtn">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <script>
        // å¤šè¯­è¨€é…ç½®
        const translations = {
            zh: {
                langSwitch: 'åˆ‡æ¢è¯­è¨€',
                mainTitle: 'ç…§ç‰‡ç¼–è¾‘',
                chooseType: 'è¯·é€‰æ‹©æ‚¨çš„ç…§ç‰‡ç±»å‹',
                editedCardTitle: 'å·²ç¼–è¾‘å¥½çš„ç…§ç‰‡',
                editedCardDesc: 'å·²ç»åˆæˆå¥½çš„ç…§ç‰‡<br>å¯èƒ½éœ€è¦æ·»åŠ æˆ–ä¿®æ”¹æ‰‹æœºå·',
                originalCardTitle: 'ç…§ç‰‡åŸä»¶',
                originalCardDesc: 'éœ€è¦åˆæˆçš„åŸå§‹ç…§ç‰‡<br>2-3å¼ ç…§ç‰‡åˆæˆä¸€å¼ ',
                backToMain: 'è¿”å›ä¸»ç•Œé¢',
                editedStep: 'å·²ç¼–è¾‘ç…§ç‰‡å¤„ç†',
                editedPhotoLabel: 'é€‰æ‹©å·²ç¼–è¾‘å¥½çš„ç…§ç‰‡ (1å¼ )',
                noFileSelected: 'æœªé€‰æ‹©æ–‡ä»¶',
                nextStep: 'ä¸‹ä¸€æ­¥',
                originalStep: 'æ­¥éª¤ 1/3: è¾“å…¥ä¿¡æ¯',
                phoneLabel: 'æ‰‹æœºå·ç ',
                phonePlaceholder: '',
                phoneError: 'è¯·è¾“å…¥æ­£ç¡®æ ¼å¼çš„æ‰‹æœºå· (xxx-xxxx-xxxx)',
                photosLabel: 'é€‰æ‹©ç…§ç‰‡ (2-3å¼ )',
                fileError: 'è¯·é€‰æ‹©2-3å¼ ç…§ç‰‡',
                nextEditArea: 'ä¸‹ä¸€æ­¥:ç¼–è¾‘ç…§ç‰‡åŒºåŸŸ',
                backToStep1: 'è¿”å›ä¸Šä¸€æ­¥',
                mergePhotos: 'åˆæˆç…§ç‰‡',
                phoneCheckTitle: 'ğŸ“± ç…§ç‰‡ç¡®è®¤',
                phoneCheckDesc: 'æ‚¨å¯¼å…¥çš„ç…§ç‰‡ä¸Šæ˜¯å¦å·²ç»æœ‰æ‰‹æœºå·?',
                hasPhone: 'æœ‰æ‰‹æœºå·',
                noPhone: 'æ²¡æœ‰æ‰‹æœºå·',
                contactTitle: 'âœ… ç…§ç‰‡å·²å®Œæˆ',
                contactDesc1: 'æ‚¨çš„ç…§ç‰‡å·²ç»åŒ…å«æ‰‹æœºå·,æ— éœ€å†æ¬¡ç¼–è¾‘ã€‚',
                contactDesc2: 'å¦‚éœ€ä¿®æ”¹,è¯·è”ç³»ç®¡ç†å‘˜:',
                contactAdmin: 'ğŸ“ éœ€è¦ä¿®æ”¹è¯·è”ç³»ç®¡ç†å‘˜',
                contactNote: 'è¯·é€šè¿‡æ‚¨çš„è”ç³»æ–¹å¼ä¸ç®¡ç†å‘˜æ²Ÿé€š',
                close: 'å…³é—­',
                phoneInputTitle: 'ğŸ“± è¾“å…¥æ‰‹æœºå·',
                phoneInputDesc: 'è¯·è¾“å…¥è¦æ·»åŠ åˆ°ç…§ç‰‡ä¸Šçš„æ‰‹æœºå·',
                confirm: 'ç¡®è®¤',
                cancel: 'å–æ¶ˆ',
                filesSelected: 'å·²é€‰æ‹© {count} å¼ ç…§ç‰‡',
                photoNumber: 'ç…§ç‰‡ {number}',
                clickCorners: 'è¯·ç‚¹å‡»4ä¸ªè§’ç‚¹(æŒ‰é¡ºåº:å·¦ä¸Šã€å³ä¸Šã€å³ä¸‹ã€å·¦ä¸‹)',
                pointsSelected: 'å·²é€‰æ‹© {count} ä¸ªç‚¹,è¯·ç»§ç»­ç‚¹å‡»{corner}è§’',
                completed: 'âœ“ å·²å®Œæˆé€‰æ‹©',
                rotate: 'ğŸ”„ æ—‹è½¬90Â°',
                undo: 'â†¶ æ’¤é”€ä¸Šä¸€ç‚¹',
                reset: 'âœ• é‡æ–°é€‰æ‹©',
                corners: ['å·¦ä¸Š', 'å³ä¸Š', 'å³ä¸‹', 'å·¦ä¸‹'],
                step2: 'æ­¥éª¤ 2/3: é€‰æ‹©ç…§ç‰‡åŒºåŸŸ(æ¯å¼ å›¾ç‚¹å‡»4ä¸ªè§’)',
                alertSelectOne: 'è¯·é€‰æ‹©1å¼ ç…§ç‰‡',
                alertSelect23: 'è¯·é€‰æ‹©2-3å¼ ç…§ç‰‡'
            },
            vi: {
                langSwitch: 'Äá»•i ngÃ´n ngá»¯',
                mainTitle: 'Chá»‰nh sá»­a áº£nh',
                chooseType: 'Vui lÃ²ng chá»n loáº¡i áº£nh cá»§a báº¡n',
                editedCardTitle: 'áº¢nh Ä‘Ã£ chá»‰nh sá»­a',
                editedCardDesc: 'áº¢nh Ä‘Ã£ Ä‘Æ°á»£c ghÃ©p<br>CÃ³ thá»ƒ cáº§n thÃªm hoáº·c sá»­a sá»‘ Ä‘iá»‡n thoáº¡i',
                originalCardTitle: 'áº¢nh gá»‘c',
                originalCardDesc: 'áº¢nh gá»‘c cáº§n ghÃ©p<br>GhÃ©p 2-3 áº£nh thÃ nh 1',
                backToMain: 'Quay láº¡i trang chÃ­nh',
                editedStep: 'Xá»­ lÃ½ áº£nh Ä‘Ã£ chá»‰nh sá»­a',
                editedPhotoLabel: 'Chá»n áº£nh Ä‘Ã£ chá»‰nh sá»­a (1 áº£nh)',
                noFileSelected: 'ChÆ°a chá»n tá»‡p',
                nextStep: 'Tiáº¿p theo',
                originalStep: 'BÆ°á»›c 1/3: Nháº­p thÃ´ng tin',
                phoneLabel: 'Sá»‘ Ä‘iá»‡n thoáº¡i',
                phonePlaceholder: '',
                phoneError: 'Vui lÃ²ng nháº­p Ä‘Ãºng Ä‘á»‹nh dáº¡ng sá»‘ Ä‘iá»‡n thoáº¡i (xxx-xxxx-xxxx)',
                photosLabel: 'Chá»n áº£nh (2-3 áº£nh)',
                fileError: 'Vui lÃ²ng chá»n 2-3 áº£nh',
                nextEditArea: 'Tiáº¿p theo: Chá»‰nh sá»­a vÃ¹ng áº£nh',
                backToStep1: 'Quay láº¡i',
                mergePhotos: 'GhÃ©p áº£nh',
                phoneCheckTitle: 'ğŸ“± XÃ¡c nháº­n áº£nh',
                phoneCheckDesc: 'áº¢nh báº¡n nháº­p Ä‘Ã£ cÃ³ sá»‘ Ä‘iá»‡n thoáº¡i chÆ°a?',
                hasPhone: 'CÃ³ sá»‘ Ä‘iá»‡n thoáº¡i',
                noPhone: 'ChÆ°a cÃ³ sá»‘ Ä‘iá»‡n thoáº¡i',
                contactTitle: 'âœ… áº¢nh Ä‘Ã£ hoÃ n thÃ nh',
                contactDesc1: 'áº¢nh cá»§a báº¡n Ä‘Ã£ cÃ³ sá»‘ Ä‘iá»‡n thoáº¡i, khÃ´ng cáº§n chá»‰nh sá»­a láº¡i.',
                contactDesc2: 'Náº¿u cáº§n sá»­a Ä‘á»•i, vui lÃ²ng liÃªn há»‡ quáº£n trá»‹ viÃªn:',
                contactAdmin: 'ğŸ“ Cáº§n sá»­a Ä‘á»•i vui lÃ²ng liÃªn há»‡ quáº£n trá»‹ viÃªn',
                contactNote: 'Vui lÃ²ng liÃªn láº¡c vá»›i quáº£n trá»‹ viÃªn qua phÆ°Æ¡ng thá»©c liÃªn há»‡ cá»§a báº¡n',
                close: 'ÄÃ³ng',
                phoneInputTitle: 'ğŸ“± Nháº­p sá»‘ Ä‘iá»‡n thoáº¡i',
                phoneInputDesc: 'Vui lÃ²ng nháº­p sá»‘ Ä‘iá»‡n thoáº¡i Ä‘á»ƒ thÃªm vÃ o áº£nh',
                confirm: 'XÃ¡c nháº­n',
                cancel: 'Há»§y',
                filesSelected: 'ÄÃ£ chá»n {count} áº£nh',
                photoNumber: 'áº¢nh {number}',
                clickCorners: 'Nháº¥p vÃ o 4 gÃ³c (theo thá»© tá»±: trÃªn trÃ¡i, trÃªn pháº£i, dÆ°á»›i pháº£i, dÆ°á»›i trÃ¡i)',
                pointsSelected: 'ÄÃ£ chá»n {count} Ä‘iá»ƒm, tiáº¿p tá»¥c nháº¥p gÃ³c {corner}',
                completed: 'âœ“ HoÃ n thÃ nh chá»n',
                rotate: 'ğŸ”„ Xoay 90Â°',
                undo: 'â†¶ HoÃ n tÃ¡c',
                reset: 'âœ• Äáº·t láº¡i',
                corners: ['trÃªn trÃ¡i', 'trÃªn pháº£i', 'dÆ°á»›i pháº£i', 'dÆ°á»›i trÃ¡i'],
                step2: 'BÆ°á»›c 2/3: Chá»n vÃ¹ng áº£nh (Nháº¥p 4 gÃ³c cho má»—i áº£nh)',
                alertSelectOne: 'Vui lÃ²ng chá»n 1 áº£nh',
                alertSelect23: 'Vui lÃ²ng chá»n 2-3 áº£nh'
            },
            ru: {
                langSwitch: 'Ğ¡Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ ÑĞ·Ñ‹Ğº',
                mainTitle: 'Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¾Ñ€ Ñ„Ğ¾Ñ‚Ğ¾',
                chooseType: 'ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ‚Ğ¸Ğ¿ Ñ„Ğ¾Ñ‚Ğ¾',
                editedCardTitle: 'ĞÑ‚Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ Ñ„Ğ¾Ñ‚Ğ¾',
                editedCardDesc: 'Ğ£Ğ¶Ğµ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¾Ğµ Ñ„Ğ¾Ñ‚Ğ¾<br>ĞœĞ¾Ğ¶ĞµÑ‚ Ğ¿Ğ¾Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ñ‚ÑŒÑÑ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¸Ğ»Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ¼ĞµÑ€ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğ°',
                originalCardTitle: 'ĞÑ€Ğ¸Ğ³Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ„Ğ¾Ñ‚Ğ¾',
                originalCardDesc: 'Ğ˜ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ñ„Ğ¾Ñ‚Ğ¾ Ğ´Ğ»Ñ Ğ¾Ğ±ÑŠĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ<br>ĞĞ±ÑŠĞµĞ´Ğ¸Ğ½Ğ¸Ñ‚ÑŒ 2-3 Ñ„Ğ¾Ñ‚Ğ¾ Ğ² Ğ¾Ğ´Ğ½Ğ¾',
                backToMain: 'ĞĞ°Ğ·Ğ°Ğ´ Ğ² Ğ¼ĞµĞ½Ñ',
                editedStep: 'ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾Ñ‚Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ñ„Ğ¾Ñ‚Ğ¾',
                editedPhotoLabel: 'Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¾Ñ‚Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ Ñ„Ğ¾Ñ‚Ğ¾ (1 Ñ„Ğ¾Ñ‚Ğ¾)',
                noFileSelected: 'Ğ¤Ğ°Ğ¹Ğ» Ğ½Ğµ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½',
                nextStep: 'Ğ”Ğ°Ğ»ĞµĞµ',
                originalStep: 'Ğ¨Ğ°Ğ³ 1/3: Ğ’Ğ²Ğ¾Ğ´ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸',
                phoneLabel: 'ĞĞ¾Ğ¼ĞµÑ€ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğ°',
                phonePlaceholder: '',
                phoneError: 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ¾Ğ¼ĞµÑ€ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğ° Ğ² Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ¼ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ (xxx-xxxx-xxxx)',
                photosLabel: 'Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ„Ğ¾Ñ‚Ğ¾ (2-3 Ñ„Ğ¾Ñ‚Ğ¾)',
                fileError: 'Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ 2-3 Ñ„Ğ¾Ñ‚Ğ¾',
                nextEditArea: 'Ğ”Ğ°Ğ»ĞµĞµ: Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¾Ğ±Ğ»Ğ°ÑÑ‚ÑŒ Ñ„Ğ¾Ñ‚Ğ¾',
                backToStep1: 'ĞĞ°Ğ·Ğ°Ğ´',
                mergePhotos: 'ĞĞ±ÑŠĞµĞ´Ğ¸Ğ½Ğ¸Ñ‚ÑŒ Ñ„Ğ¾Ñ‚Ğ¾',
                phoneCheckTitle: 'ğŸ“± ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ñ„Ğ¾Ñ‚Ğ¾',
                phoneCheckDesc: 'ĞĞ° Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ¼ Ñ„Ğ¾Ñ‚Ğ¾ ÑƒĞ¶Ğµ ĞµÑÑ‚ÑŒ Ğ½Ğ¾Ğ¼ĞµÑ€ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğ°?',
                hasPhone: 'Ğ•ÑÑ‚ÑŒ Ğ½Ğ¾Ğ¼ĞµÑ€',
                noPhone: 'ĞĞµÑ‚ Ğ½Ğ¾Ğ¼ĞµÑ€Ğ°',
                contactTitle: 'âœ… Ğ¤Ğ¾Ñ‚Ğ¾ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¾',
                contactDesc1: 'Ğ’Ğ°ÑˆĞµ Ñ„Ğ¾Ñ‚Ğ¾ ÑƒĞ¶Ğµ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ Ğ½Ğ¾Ğ¼ĞµÑ€ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğ°, Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ½Ğµ Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ.',
                contactDesc2: 'Ğ•ÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ, ÑĞ²ÑĞ¶Ğ¸Ñ‚ĞµÑÑŒ Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ¼:',
                contactAdmin: 'ğŸ“ Ğ”Ğ»Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹ ÑĞ²ÑĞ¶Ğ¸Ñ‚ĞµÑÑŒ Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ¼',
                contactNote: 'ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, ÑĞ²ÑĞ¶Ğ¸Ñ‚ĞµÑÑŒ Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ¼ Ñ‡ĞµÑ€ĞµĞ· Ğ²Ğ°Ñˆ ÑĞ¿Ğ¾ÑĞ¾Ğ± ÑĞ²ÑĞ·Ğ¸',
                close: 'Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ',
                phoneInputTitle: 'ğŸ“± Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ¾Ğ¼ĞµÑ€ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğ°',
                phoneInputDesc: 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ¾Ğ¼ĞµÑ€ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğ° Ğ´Ğ»Ñ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ½Ğ° Ñ„Ğ¾Ñ‚Ğ¾',
                confirm: 'ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ´Ğ¸Ñ‚ÑŒ',
                cancel: 'ĞÑ‚Ğ¼ĞµĞ½Ğ°',
                filesSelected: 'Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ¾ Ñ„Ğ¾Ñ‚Ğ¾: {count}',
                photoNumber: 'Ğ¤Ğ¾Ñ‚Ğ¾ {number}',
                clickCorners: 'ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ğ½Ğ° 4 ÑƒĞ³Ğ»Ğ° (Ğ¿Ğ¾ Ğ¿Ğ¾Ñ€ÑĞ´ĞºÑƒ: Ğ²ĞµÑ€Ñ…Ğ½Ğ¸Ğ¹ Ğ»ĞµĞ²Ñ‹Ğ¹, Ğ²ĞµÑ€Ñ…Ğ½Ğ¸Ğ¹ Ğ¿Ñ€Ğ°Ğ²Ñ‹Ğ¹, Ğ½Ğ¸Ğ¶Ğ½Ğ¸Ğ¹ Ğ¿Ñ€Ğ°Ğ²Ñ‹Ğ¹, Ğ½Ğ¸Ğ¶Ğ½Ğ¸Ğ¹ Ğ»ĞµĞ²Ñ‹Ğ¹)',
                pointsSelected: 'Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ¾ Ñ‚Ğ¾Ñ‡ĞµĞº: {count}, Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°Ğ¹Ñ‚Ğµ Ğ½Ğ°Ğ¶Ğ¸Ğ¼Ğ°Ñ‚ÑŒ ÑƒĞ³Ğ¾Ğ» {corner}',
                completed: 'âœ“ Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½',
                rotate: 'ğŸ”„ ĞŸĞ¾Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ğ½Ğ° 90Â°',
                undo: 'â†¶ ĞÑ‚Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ',
                reset: 'âœ• Ğ¡Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ',
                corners: ['Ğ²ĞµÑ€Ñ…Ğ½Ğ¸Ğ¹ Ğ»ĞµĞ²Ñ‹Ğ¹', 'Ğ²ĞµÑ€Ñ…Ğ½Ğ¸Ğ¹ Ğ¿Ñ€Ğ°Ğ²Ñ‹Ğ¹', 'Ğ½Ğ¸Ğ¶Ğ½Ğ¸Ğ¹ Ğ¿Ñ€Ğ°Ğ²Ñ‹Ğ¹', 'Ğ½Ğ¸Ğ¶Ğ½Ğ¸Ğ¹ Ğ»ĞµĞ²Ñ‹Ğ¹'],
                step2: 'Ğ¨Ğ°Ğ³ 2/3: Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¾Ğ±Ğ»Ğ°ÑÑ‚ÑŒ Ñ„Ğ¾Ñ‚Ğ¾ (ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ 4 ÑƒĞ³Ğ»Ğ° Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾)',
                alertSelectOne: 'Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ 1 Ñ„Ğ¾Ñ‚Ğ¾',
                alertSelect23: 'Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ 2-3 Ñ„Ğ¾Ñ‚Ğ¾'
            },
            ko: {
                langSwitch: 'ì–¸ì–´ ë³€ê²½',
                mainTitle: 'ì‚¬ì§„ í¸ì§‘ê¸°',
                chooseType: 'ì‚¬ì§„ ìœ í˜•ì„ ì„ íƒí•˜ì„¸ìš”',
                editedCardTitle: 'í¸ì§‘ëœ ì‚¬ì§„',
                editedCardDesc: 'ì´ë¯¸ í•©ì„±ëœ ì‚¬ì§„<br>ì „í™”ë²ˆí˜¸ ì¶”ê°€ ë˜ëŠ” ìˆ˜ì •ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤',
                originalCardTitle: 'ì›ë³¸ ì‚¬ì§„',
                originalCardDesc: 'í•©ì„±ì´ í•„ìš”í•œ ì›ë³¸ ì‚¬ì§„<br>2-3ì¥ì˜ ì‚¬ì§„ì„ í•œ ì¥ìœ¼ë¡œ í•©ì„±',
                backToMain: 'ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°',
                editedStep: 'í¸ì§‘ëœ ì‚¬ì§„ ì²˜ë¦¬',
                editedPhotoLabel: 'í¸ì§‘ëœ ì‚¬ì§„ ì„ íƒ (1ì¥)',
                noFileSelected: 'íŒŒì¼ì´ ì„ íƒë˜ì§€ ì•ŠìŒ',
                nextStep: 'ë‹¤ìŒ',
                originalStep: 'ë‹¨ê³„ 1/3: ì •ë³´ ì…ë ¥',
                phoneLabel: 'ì „í™”ë²ˆí˜¸',
                phonePlaceholder: '',
                phoneError: 'ì˜¬ë°”ë¥¸ í˜•ì‹ì˜ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (xxx-xxxx-xxxx)',
                photosLabel: 'ì‚¬ì§„ ì„ íƒ (2-3ì¥)',
                fileError: '2-3ì¥ì˜ ì‚¬ì§„ì„ ì„ íƒí•˜ì„¸ìš”',
                nextEditArea: 'ë‹¤ìŒ: ì‚¬ì§„ ì˜ì—­ í¸ì§‘',
                backToStep1: 'ì´ì „ìœ¼ë¡œ',
                mergePhotos: 'ì‚¬ì§„ í•©ì„±',
                phoneCheckTitle: 'ğŸ“± ì‚¬ì§„ í™•ì¸',
                phoneCheckDesc: 'ê°€ì ¸ì˜¨ ì‚¬ì§„ì— ì´ë¯¸ ì „í™”ë²ˆí˜¸ê°€ ìˆìŠµë‹ˆê¹Œ?',
                hasPhone: 'ì „í™”ë²ˆí˜¸ ìˆìŒ',
                noPhone: 'ì „í™”ë²ˆí˜¸ ì—†ìŒ',
                contactTitle: 'âœ… ì‚¬ì§„ ì™„ë£Œ',
                contactDesc1: 'ì‚¬ì§„ì— ì´ë¯¸ ì „í™”ë²ˆí˜¸ê°€ í¬í•¨ë˜ì–´ ìˆì–´ ë‹¤ì‹œ í¸ì§‘í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.',
                contactDesc2: 'ìˆ˜ì •ì´ í•„ìš”í•œ ê²½ìš° ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”:',
                contactAdmin: 'ğŸ“ ìˆ˜ì •ì´ í•„ìš”í•˜ë©´ ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”',
                contactNote: 'ì—°ë½ ë°©ë²•ì„ í†µí•´ ê´€ë¦¬ìì™€ ì†Œí†µí•˜ì„¸ìš”',
                close: 'ë‹«ê¸°',
                phoneInputTitle: 'ğŸ“± ì „í™”ë²ˆí˜¸ ì…ë ¥',
                phoneInputDesc: 'ì‚¬ì§„ì— ì¶”ê°€í•  ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”',
                confirm: 'í™•ì¸',
                cancel: 'ì·¨ì†Œ',
                filesSelected: '{count}ì¥ì˜ ì‚¬ì§„ì´ ì„ íƒë¨',
                photoNumber: 'ì‚¬ì§„ {number}',
                clickCorners: '4ê°œì˜ ëª¨ì„œë¦¬ë¥¼ í´ë¦­í•˜ì„¸ìš” (ìˆœì„œ: ì™¼ìª½ ìœ„, ì˜¤ë¥¸ìª½ ìœ„, ì˜¤ë¥¸ìª½ ì•„ë˜, ì™¼ìª½ ì•„ë˜)',
                pointsSelected: '{count}ê°œ í¬ì¸íŠ¸ ì„ íƒë¨, {corner} ëª¨ì„œë¦¬ë¥¼ ê³„ì† í´ë¦­í•˜ì„¸ìš”',
                completed: 'âœ“ ì„ íƒ ì™„ë£Œ',
                rotate: 'ğŸ”„ 90Â° íšŒì „',
                undo: 'â†¶ ë§ˆì§€ë§‰ ì·¨ì†Œ',
                reset: 'âœ• ì¬ì„¤ì •',
                corners: ['ì™¼ìª½ ìœ„', 'ì˜¤ë¥¸ìª½ ìœ„', 'ì˜¤ë¥¸ìª½ ì•„ë˜', 'ì™¼ìª½ ì•„ë˜'],
                step2: 'ë‹¨ê³„ 2/3: ì‚¬ì§„ ì˜ì—­ ì„ íƒ (ê° ì‚¬ì§„ì˜ 4ê°œ ëª¨ì„œë¦¬ í´ë¦­)',
                alertSelectOne: '1ì¥ì˜ ì‚¬ì§„ì„ ì„ íƒí•˜ì„¸ìš”',
                alertSelect23: '2-3ì¥ì˜ ì‚¬ì§„ì„ ì„ íƒí•˜ì„¸ìš”'
            }
        };

        let currentLang = 'zh';
        const phoneInput = document.getElementById('phone');
        const photosInput = document.getElementById('photos');
        const editedPhotoInput = document.getElementById('editedPhoto');
        const editedPhoneInput = document.getElementById('editedPhone');
        const phoneError = document.getElementById('phoneError');
        const fileError = document.getElementById('fileError');
        const fileInfo = document.getElementById('fileInfo');
        const editedFileInfo = document.getElementById('editedFileInfo');
        const editorArea = document.getElementById('editorArea');
        const resultCanvas = document.getElementById('result');
        
        let images = [];
        let imagePoints = [];
        let imageRotations = [];
        let currentMode = '';
        let editedImage = null;

        // è¯­è¨€é€‰æ‹©
        function selectLanguage(lang) {
            currentLang = lang;
            document.body.className = 'lang-' + lang;
            updateLanguage();
            document.getElementById('languageSelect').classList.add('hidden');
            document.getElementById('mainTitle').classList.remove('hidden');
            document.getElementById('mainChoice').classList.remove('hidden');
            document.querySelector('.lang-switch').classList.remove('hidden');
        }

        function backToLanguageSelect() {
            document.getElementById('languageSelect').classList.remove('hidden');
            document.getElementById('mainTitle').classList.add('hidden');
            document.getElementById('mainChoice').classList.add('hidden');
            document.getElementById('editedFlow').classList.add('hidden');
            document.getElementById('originalFlow').classList.add('hidden');
            document.getElementById('editorArea').style.display = 'none';
            document.getElementById('backButton').style.display = 'none';
            document.getElementById('mergeButton').style.display = 'none';
            document.querySelector('.lang-switch').classList.add('hidden');
            
            document.getElementById('phoneCheckModal').style.display = 'none';
            document.getElementById('contactModal').style.display = 'none';
            document.getElementById('phoneInputModal').style.display = 'none';
            
            resultCanvas.style.display = 'none';
            
            images = [];
            imagePoints = [];
            imageRotations = [];
            editedImage = null;
            editorArea.innerHTML = '';
            
            if (photosInput) photosInput.value = '';
            if (editedPhotoInput) editedPhotoInput.value = '';
            if (phoneInput) phoneInput.value = '';
            if (editedPhoneInput) editedPhoneInput.value = '';
            
            document.body.className = '';
        }

        function updateLanguage() {
            const t = translations[currentLang];
            
            document.getElementById('langSwitchText').textContent = t.langSwitch;
            document.getElementById('mainTitle').textContent = t.mainTitle;
            document.getElementById('chooseTypeText').textContent = t.chooseType;
            document.getElementById('editedCardTitle').textContent = t.editedCardTitle;
            document.getElementById('editedCardDesc').innerHTML = t.editedCardDesc;
            document.getElementById('originalCardTitle').textContent = t.originalCardTitle;
            document.getElementById('originalCardDesc').innerHTML = t.originalCardDesc;
            document.getElementById('backToMainText').textContent = t.backToMain;
            document.getElementById('backToMainText2').textContent = t.backToMain;
            document.getElementById('editedStepText').textContent = t.editedStep;
            document.getElementById('editedPhotoLabel').textContent = t.editedPhotoLabel;
            document.getElementById('editedFileInfo').textContent = t.noFileSelected;
            document.getElementById('editedNextBtn').textContent = t.nextStep;
            document.getElementById('originalStepText').textContent = t.originalStep;
            document.getElementById('phoneLabel').textContent = t.phoneLabel;
            document.getElementById('phone').placeholder = t.phonePlaceholder;
            document.getElementById('phoneError').textContent = t.phoneError;
            document.getElementById('photosLabel').textContent = t.photosLabel;
            document.getElementById('fileInfo').textContent = t.noFileSelected;
            document.getElementById('fileError').textContent = t.fileError;
            document.getElementById('originalNextBtn').textContent = t.nextEditArea;
            document.getElementById('backToStep1Text').textContent = t.backToStep1;
            document.getElementById('mergeButtonText').textContent = t.mergePhotos;
            document.getElementById('phoneCheckTitle').textContent = t.phoneCheckTitle;
            document.getElementById('phoneCheckDesc').textContent = t.phoneCheckDesc;
            document.getElementById('hasPhoneBtn').textContent = t.hasPhone;
            document.getElementById('noPhoneBtn').textContent = t.noPhone;
            document.getElementById('contactTitle').textContent = t.contactTitle;
            document.getElementById('contactDesc1').textContent = t.contactDesc1;
            document.getElementById('contactDesc2').textContent = t.contactDesc2;
            document.getElementById('contactAdmin').textContent = t.contactAdmin;
            document.getElementById('contactNote').textContent = t.contactNote;
            document.getElementById('closeModalBtn').textContent = t.close;
            document.getElementById('phoneInputTitle').textContent = t.phoneInputTitle;
            document.getElementById('phoneInputDesc').textContent = t.phoneInputDesc;
            document.getElementById('editedPhone').placeholder = t.phonePlaceholder;
            document.getElementById('editedPhoneError').textContent = t.phoneError;
            document.getElementById('confirmPhoneBtn').textContent = t.confirm;
            document.getElementById('cancelPhoneBtn').textContent = t.cancel;
        }

        // æ‰‹æœºå·è¾“å…¥æ ¼å¼åŒ–
        function formatPhoneInput(input) {
            input.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length > 3 && value.length <= 7) {
                    value = value.slice(0, 3) + '-' + value.slice(3);
                } else if (value.length > 7) {
                    value = value.slice(0, 3) + '-' + value.slice(3, 7) + '-' + value.slice(7, 11);
                }
                e.target.value = value;
            });
        }

        formatPhoneInput(phoneInput);
        formatPhoneInput(editedPhoneInput);

        photosInput.addEventListener('change', function(e) {
            const t = translations[currentLang];
            const files = e.target.files;
            if (files.length > 0) {
                fileInfo.textContent = t.filesSelected.replace('{count}', files.length);
                fileInfo.style.color = '#4A90A4';
            } else {
                fileInfo.textContent = t.noFileSelected;
                fileInfo.style.color = '#5A7A8F';
            }
            fileError.style.display = 'none';
        });

        editedPhotoInput.addEventListener('change', function(e) {
            const t = translations[currentLang];
            const files = e.target.files;
            if (files.length > 0) {
                editedFileInfo.textContent = t.filesSelected.replace('{count}', files.length);
                editedFileInfo.style.color = '#4A90A4';
            } else {
                editedFileInfo.textContent = t.noFileSelected;
                editedFileInfo.style.color = '#5A7A8F';
            }
        });

        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('mainChoice').classList.add('hidden');
            
            if (mode === 'edited') {
                document.getElementById('editedFlow').classList.remove('hidden');
            } else {
                document.getElementById('originalFlow').classList.remove('hidden');
            }
        }

        function backToMain() {
            document.getElementById('mainChoice').classList.remove('hidden');
            document.getElementById('editedFlow').classList.add('hidden');
            document.getElementById('originalFlow').classList.add('hidden');
            document.getElementById('editorArea').style.display = 'none';
            document.getElementById('backButton').style.display = 'none';
            document.getElementById('mergeButton').style.display = 'none';
            resultCanvas.style.display = 'none';
            
            images = [];
            imagePoints = [];
            imageRotations = [];
            editedImage = null;
            editorArea.innerHTML = '';
        }

        function checkEditedPhoto() {
            const t = translations[currentLang];
            const files = editedPhotoInput.files;
            if (files.length !== 1) {
                alert(t.alertSelectOne);
                return;
            }

            document.getElementById('phoneCheckModal').style.display = 'flex';
        }

        function hasPhoneNumber() {
            document.getElementById('phoneCheckModal').style.display = 'none';
            document.getElementById('contactModal').style.display = 'flex';
        }

        function noPhoneNumber() {
            document.getElementById('phoneCheckModal').style.display = 'none';
            document.getElementById('phoneInputModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('contactModal').style.display = 'none';
            backToMain();
        }

        function closePhoneInputModal() {
            document.getElementById('phoneInputModal').style.display = 'none';
        }

        function confirmEditedPhone() {
            const phone = editedPhoneInput.value;
            const phonePattern = /^\d{3}-\d{4}-\d{4}$/;
            
            if (!phonePattern.test(phone)) {
                document.getElementById('editedPhoneError').style.display = 'block';
                return;
            }

            document.getElementById('editedPhoneError').style.display = 'none';
            document.getElementById('phoneInputModal').style.display = 'none';

            const file = editedPhotoInput.files[0];
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    editedImage = img;
                    mergeEditedPhoto(phone);
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function mergeEditedPhoto(phone) {
            document.getElementById('editedFlow').classList.add('hidden');
            
            const img = editedImage;
            const canvas = resultCanvas;
            const ctx = canvas.getContext('2d');

            const headerHeight = 150;
            const imgWidth = img.width;
            const imgHeight = img.height;

            canvas.width = imgWidth;
            canvas.height = headerHeight + imgHeight;

            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            let fontSize = headerHeight * 0.85;
            ctx.font = `bold ${fontSize}px Arial`;
            
            let textWidth = ctx.measureText(phone).width;
            if (textWidth > canvas.width * 0.95) {
                fontSize = (canvas.width * 0.95) / ctx.measureText(phone).width * fontSize;
                ctx.font = `bold ${fontSize}px Arial`;
            }
            
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillStyle = 'black';
            ctx.fillText(phone, canvas.width / 2, headerHeight / 2);

            ctx.drawImage(img, 0, headerHeight, imgWidth, imgHeight);

            canvas.style.display = 'block';

            canvas.toBlob(function(blob) {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `åˆæˆç…§ç‰‡_${phone}.png`;
                a.click();
                URL.revokeObjectURL(url);
            });
        }

        function startEditing() {
            const t = translations[currentLang];
            const phone = phoneInput.value;
            const files = photosInput.files;

            const phonePattern = /^\d{3}-\d{4}-\d{4}$/;
            if (!phonePattern.test(phone)) {
                phoneError.style.display = 'block';
                return;
            }

            if (files.length < 2 || files.length > 3) {
                fileError.style.display = 'block';
                return;
            }

            document.getElementById('originalFlow').classList.add('hidden');
            editorArea.style.display = 'block';
            document.getElementById('backButton').style.display = 'block';
            editorArea.innerHTML = `<div class="step-indicator">${t.step2}</div>`;

            const imagePromises = Array.from(files).map(file => {
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const img = new Image();
                        img.onload = function() {
                            resolve(img);
                        };
                        img.src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                });
            });

            Promise.all(imagePromises).then(loadedImages => {
                images = loadedImages;
                imagePoints = images.map(() => []);
                imageRotations = images.map(() => 0);
                createEditors();
            });
        }

        function createEditors() {
            const t = translations[currentLang];
            images.forEach((img, index) => {
                const editorDiv = document.createElement('div');
                editorDiv.className = 'image-editor';
                editorDiv.innerHTML = `
                    <div class="editor-title">${t.photoNumber.replace('{number}', index + 1)}</div>
                    <div class="canvas-container">
                        <canvas class="edit-canvas" id="canvas${index}"></canvas>
                    </div>
                    <div class="instruction">
                        <span class="point-info" id="info${index}">${t.clickCorners}</span>
                        <div class="control-buttons">
                            <button class="small-btn rotate" onclick="rotateImage(${index})">${t.rotate}</button>
                            <button class="small-btn undo" onclick="undoPoint(${index})">${t.undo}</button>
                            <button class="small-btn" onclick="resetPoints(${index})">${t.reset}</button>
                        </div>
                    </div>
                `;
                editorArea.appendChild(editorDiv);

                const canvas = document.getElementById(`canvas${index}`);
                const ctx = canvas.getContext('2d');
                
                const maxWidth = 800;
                const scale = Math.min(1, maxWidth / img.width);
                canvas.width = img.width * scale;
                canvas.height = img.height * scale;
                
                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

                canvas.addEventListener('click', (e) => handleCanvasClick(e, canvas, ctx, img, index, scale));
            });
        }

        function handleCanvasClick(e, canvas, ctx, img, index, scale) {
            if (imagePoints[index].length >= 4) return;

            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX - rect.left) * (canvas.width / rect.width);
            const y = (e.clientY - rect.top) * (canvas.height / rect.height);

            imagePoints[index].push({ x, y });
            redrawCanvas(index);
            updatePointInfo(index);

            if (imagePoints[index].length === 4) {
                checkAllComplete();
            }
        }

        function undoPoint(index) {
            if (imagePoints[index].length > 0) {
                imagePoints[index].pop();
                redrawCanvas(index);
                updatePointInfo(index);
                document.getElementById('mergeButton').style.display = 'none';
            }
        }

        function resetPoints(index) {
            imagePoints[index] = [];
            redrawCanvas(index);
            updatePointInfo(index);
            document.getElementById('mergeButton').style.display = 'none';
        }

        function rotateImage(index) {
            imageRotations[index] = (imageRotations[index] + 90) % 360;
            
            const canvas = document.getElementById(`canvas${index}`);
            const oldWidth = canvas.width;
            const oldHeight = canvas.height;
            
            imagePoints[index] = imagePoints[index].map(point => {
                let newX, newY;
                switch(imageRotations[index]) {
                    case 90:
                        newX = oldHeight - point.y;
                        newY = point.x;
                        break;
                    case 180:
                        newX = oldWidth - point.x;
                        newY = oldHeight - point.y;
                        break;
                    case 270:
                        newX = point.y;
                        newY = oldWidth - point.x;
                        break;
                    default:
                        newX = point.x;
                        newY = point.y;
                }
                return { x: newX, y: newY };
            });
            
            redrawCanvas(index);
        }

        function redrawCanvas(index) {
            const canvas = document.getElementById(`canvas${index}`);
            const ctx = canvas.getContext('2d');
            const img = images[index];
            const rotation = imageRotations[index];
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            if (rotation === 90 || rotation === 270) {
                const tempWidth = canvas.width;
                canvas.width = canvas.height;
                canvas.height = tempWidth;
            }
            
            ctx.save();
            ctx.translate(canvas.width / 2, canvas.height / 2);
            ctx.rotate((rotation * Math.PI) / 180);
            
            if (rotation === 90 || rotation === 270) {
                ctx.drawImage(img, -canvas.height / 2, -canvas.width / 2, canvas.height, canvas.width);
            } else {
                ctx.drawImage(img, -canvas.width / 2, -canvas.height / 2, canvas.width, canvas.height);
            }
            ctx.restore();

            imagePoints[index].forEach((point, i) => {
                ctx.fillStyle = '#C73E1D';
                ctx.beginPath();
                ctx.arc(point.x, point.y, 8, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = '#FAFAF8';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(i + 1, point.x, point.y);
            });

            if (imagePoints[index].length > 1) {
                ctx.strokeStyle = '#4A90A4';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(imagePoints[index][0].x, imagePoints[index][0].y);
                for (let i = 1; i < imagePoints[index].length; i++) {
                    ctx.lineTo(imagePoints[index][i].x, imagePoints[index][i].y);
                }
                if (imagePoints[index].length === 4) {
                    ctx.closePath();
                }
                ctx.stroke();
            }
        }

        function updatePointInfo(index) {
            const t = translations[currentLang];
            const info = document.getElementById(`info${index}`);
            if (imagePoints[index].length < 4) {
                info.textContent = t.pointsSelected
                    .replace('{count}', imagePoints[index].length)
                    .replace('{corner}', t.corners[imagePoints[index].length]);
                info.style.color = '#3E5F8A';
            } else {
                info.textContent = t.completed;
                info.style.color = '#4A90A4';
            }
        }

        function checkAllComplete() {
            if (imagePoints.every(points => points.length === 4)) {
                document.getElementById('mergeButton').style.display = 'block';
            }
        }

        function goBackToStep1() {
            document.getElementById('originalFlow').classList.remove('hidden');
            editorArea.style.display = 'none';
            document.getElementById('backButton').style.display = 'none';
            document.getElementById('mergeButton').style.display = 'none';
            resultCanvas.style.display = 'none';
            
            images = [];
            imagePoints = [];
            imageRotations = [];
            editorArea.innerHTML = '';
        }

        function perspectiveTransform(srcPoints, img, rotation) {
            const rotatedCanvas = document.createElement('canvas');
            
            if (rotation === 90 || rotation === 270) {
                rotatedCanvas.width = img.height;
                rotatedCanvas.height = img.width;
            } else {
                rotatedCanvas.width = img.width;
                rotatedCanvas.height = img.height;
            }
            
            const rotCtx = rotatedCanvas.getContext('2d');
            rotCtx.save();
            rotCtx.translate(rotatedCanvas.width / 2, rotatedCanvas.height / 2);
            rotCtx.rotate((rotation * Math.PI) / 180);
            
            if (rotation === 90 || rotation === 270) {
                rotCtx.drawImage(img, -img.height / 2, -img.width / 2, img.height, img.width);
            } else {
                rotCtx.drawImage(img, -img.width / 2, -img.height / 2, img.width, img.height);
            }
            rotCtx.restore();
            
            const minX = Math.min(srcPoints[0].x, srcPoints[1].x, srcPoints[2].x, srcPoints[3].x);
            const maxX = Math.max(srcPoints[0].x, srcPoints[1].x, srcPoints[2].x, srcPoints[3].x);
            const minY = Math.min(srcPoints[0].y, srcPoints[1].y, srcPoints[2].y, srcPoints[3].y);
            const maxY = Math.max(srcPoints[0].y, srcPoints[1].y, srcPoints[2].y, srcPoints[3].y);
            
            const width = maxX - minX;
            const height = maxY - minY;

            const destCanvas = document.createElement('canvas');
            destCanvas.width = Math.round(width);
            destCanvas.height = Math.round(height);
            const destCtx = destCanvas.getContext('2d');

            destCtx.drawImage(
                rotatedCanvas,
                minX, minY, width, height,
                0, 0, width, height
            );

            return destCanvas;
        }

        function mergePhotos() {
            editorArea.style.display = 'none';
            document.getElementById('backButton').style.display = 'none';
            document.getElementById('mergeButton').style.display = 'none';
            
            const transformedImages = images.map((img, index) => {
                const canvas = document.getElementById(`canvas${index}`);
                const scale = canvas.width / img.width;
                const scaledPoints = imagePoints[index].map(p => ({
                    x: p.x / scale,
                    y: p.y / scale
                }));
                return perspectiveTransform(scaledPoints, img, imageRotations[index]);
            });

            createMergedImage(phoneInput.value, transformedImages);
        }

        function createMergedImage(phone, images) {
            const canvas = resultCanvas;
            const ctx = canvas.getContext('2d');

            const maxWidth = Math.max(...images.map(img => img.width));
            const headerHeight = 150;
            const totalHeight = headerHeight + images.reduce((sum, img) => {
                const scaledHeight = (maxWidth / img.width) * img.height;
                return sum + scaledHeight;
            }, 0);

            canvas.width = maxWidth;
            canvas.height = totalHeight;

            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, headerHeight);
            
            let fontSize = headerHeight * 0.85;
            ctx.font = `bold ${fontSize}px Arial`;
            
            let textWidth = ctx.measureText(phone).width;
            if (textWidth > canvas.width * 0.95) {
                fontSize = (canvas.width * 0.95) / ctx.measureText(phone).width * fontSize;
                ctx.font = `bold ${fontSize}px Arial`;
            }
            
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillStyle = 'black';
            ctx.fillText(phone, canvas.width / 2, headerHeight / 2);

            let currentY = headerHeight;
            images.forEach(img => {
                const scaledHeight = (maxWidth / img.width) * img.height;
                ctx.drawImage(img, 0, currentY, maxWidth, scaledHeight);
                currentY += scaledHeight;
            });

            canvas.style.display = 'block';

            canvas.toBlob(function(blob) {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `åˆæˆç…§ç‰‡_${phone}.png`;
                a.click();
                URL.revokeObjectURL(url);
            });
        }

        window.selectLanguage = selectLanguage;
        window.backToLanguageSelect = backToLanguageSelect;
        window.selectMode = selectMode;
        window.backToMain = backToMain;
        window.checkEditedPhoto = checkEditedPhoto;
        window.hasPhoneNumber = hasPhoneNumber;
        window.noPhoneNumber = noPhoneNumber;
        window.closeModal = closeModal;
        window.closePhoneInputModal = closePhoneInputModal;
        window.confirmEditedPhone = confirmEditedPhone;
        window.startEditing = startEditing;
        window.undoPoint = undoPoint;
        window.resetPoints = resetPoints;
        window.rotateImage = rotateImage;
        window.goBackToStep1 = goBackToStep1;
        window.mergePhotos = mergePhotos;
    </script>
</body>
</html>